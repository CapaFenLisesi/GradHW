\section*{Problem 2a: Single Open Stub Tuner}

The goal is to match a load impedance to a transmission line by placing a stub
of a certain length $l_s$ a certain distance $l_l$ away from a load. To be
matched means that the input impedance looks like the characteristic impedance
$Z_c$. To the source, the two paths (the stub and the load) will seem to be
connected in parallel. Thus, quite generally:

\[ 
        Z_{in} = Z_{stub} || Z'_l
\]

where $Z'_l$ is the impedance of the load transformed by a certain length
$l_{l}$ down the line. A load of impedance $Z_l$ looks the following
impedance when we're a length ``l'' down the line:

\[ 
        Z'_l(l) = Z_c \frac{Z_l + j Z_c \tan \beta l}{Z_c + j Z_l \tan \beta l} 
\]

However, because we are combining parallel impedances it will be easier to deal
with admittances:

\[ 
        Y_{in} = Y_{stub} + Y'_l 
\]

where

\[ 
        Y'_l(l_l) = Y_c \frac{Y_l + j Y_c\tan\beta l_l}{Y_c + j Y_l \tan \beta
        l_l}
\]

Our goal is to make $\Re \left( Y_{in} \right) = Z_c$ and $ \Im \left( Y_{in}
\right) = 0$. We have an expression for $Y'_l$ already. We'd like an expression
for $Y_{stub}$. However, $Y_{stub}$ is just a infinite impedance (zero
admittance) load. Thus, we can use the same equation as before before:

\begin{align*}
    Y'_l(l_s) &= Y_c \frac{Y_s + j Y_c\tan\beta l_s}{Y_c + j Y_s \tan \beta
       l_s}  \\
       &= Y_c \frac{0 + jY_c\tan\beta l_s}{Y_c + j0\tan\beta l_s} \\
       &= j Y_c \tan \beta l_s
\end{align*}

Unfortunately, the load can not, in general, be simplified any further. Thus,
the input admittance is:
\begin{align*}
    Y_{in} = Y_c \left( \frac{Y_l + j Y_c\tan\beta l_l}{Y_c + j Y_l \tan \beta
    l_l} + j \tan \beta l_s \right)
\end{align*}

In accordance with our specifications given earlier we have the following two
equations by considering the imaginary and real parts of $Y_{in}$ separately.

\begin{align*}
    \Im \left( Y_{in}  \right) &= 0 \\
                               & = \Im \left( \left( Y_l + j Y_c \tan \beta l_l
\right) \left( Y_c - j Y_l \tan \beta l_l \right) + j \tan \beta l_s \left(
Y_c^2 + Y_l^2\tan^2\beta l_l \right)\right) \\
\intertext{This yields the following equation: } 
0 &= Y_c^2\tan\beta l_l - Y_l^2 \tan \beta l_l + \tan \beta l_s \left( Y_c^2 +
Y_l^2 \tan^2\beta l_l \right)
\end{align*}

Considering, separately the real part of the input admittance.
\begin{align*}
    \Re \left( Y_{in} \right) = Y_c &= \Re \left( Y_c \left( \frac{Y_l + j
    Y_c\tan\beta l_l}{Y_c + j Y_l \tan \beta l_l} + j \tan \beta l_s \right)
\right) 
    \intertext{Re-arranged and simplified a bit:} 
    1 &= \Re \left( \frac{ \left( Y_l + jY_c\tan\beta l_l \right)\left( Y_c - j
    Y_l \tan \beta l_l \right) }{Y_c^2 + Y_l^2\tan^2\beta l_l} + j \tan \beta
    l_s \right) \\
    \intertext{Taking the real part:} 
    1 &= \frac{Y_l Y_c + Y_l Y_c \tan^2\beta l_l}{Y_c^2 + Y_l^2 \tan^2\beta l_l}
\end{align*}

These two equations can be solved simultaneously for pairs of $l_l$ and $l_s$
that satisfy them. Given the transcendental nature of these two solutions it is
not, in general, possible to find an analytic solution. However, we can reduce
the complexity of these two equations, somewhat, if we rewrite $Y_l = \alpha
Y_c$ and, instead, for known $\alpha$ solve the two equations for $l_l$ and
$l_s$. Rewriting these two equations in terms of $Y_l = \alpha Y_c$ yields:

\begin{align*}
    0 &= Y_c^2 \tan \beta l_l - \alpha^2 Y_c^2 \tan \beta l_l + \tan\beta l_s
    \left( Y_c^2 + \alpha^2 Y_c^2 \tan^2 \beta l_l \right) \\
    1 &= \frac{\alpha Y_c^2 + \alpha Y_c^2 \tan^2 \beta l_l}{Y_c^2 + \alpha^2
Y_c^2 \tan^2\beta l_l}
\end{align*}

These can be immediately reduced to:

\begin{align*}
    0 &= \tan \beta l_l \left( 1-\alpha^2 \right) + \tan \beta l_s \left( 1 +
\alpha^2 \tan^2\beta l_l \right) \\
1&= \frac{\alpha \left( 1+\tan^2\beta l_l \right)}{1+\alpha^2 \tan^2\beta l_l}
\end{align*}

%TODO: Make a plot of these for alpha = 2 (since the load is 100 ohms)
%TODO: Solve for l_s and l_l

\section*{LC Matching Network}

The goal in constructing a matching network for the load using an LC network is
going to be similar as that that was performed in the previous section. Namely,
our goal is going to be to make $Z_{in} = Z_c$ such that $\Re \left( Z_{in}
\right) = Z_c$ and $\Im \left( Z_{in} \right) = 0$. It is easy, in this case to
construct the input impedance as 

\[ 
        Z_{in} = Z_A + Z_B || Z_L 
\]

The only knowledge we have, currently, regarding $Z_A$ and $Z_B$ is that both
impedances are purely imaginary. We know that $Z_L$ is purely real ($
\SI{100}{\ohm}$). Thus, we start by considering $\Re \left( Z_{in} \right)$.

\begin{align*}
    \Re(Z_{in}) = Z_c &= \Re ( \frac{Z_B Z_L}{Z_B + Z_L} )\\
                      &= \Re ( \frac{j X_B R_L}{j X_B + R_L} ) \\
                      &= \frac{ X_B^2 R_L}{X_B^2 + R_L^2}
\end{align*}

Considering the imaginary part of $Z_{in}$

\begin{align}
    \Im \left( Z_{in} \right) = 0 &= \Im \left( j X_A + \frac{j X_B
    R_L}{j X_B + R_L} \right)	 \\
    &= \Im \left( j X_A + \frac{j X_B R_L \left( R_L - j X_B \right)}{
    X_B^2 + R_L^2} \right) \\
    &= X_A + \frac{ X_B R_L^2}{ X_B^2 + R_L^2}
\end{align}

The real part of $Z_{in}$ only involves $Z_B$. So, we can easily solve for $Z_B$
that way. Doing so yields:

\[ 
    X_B^2 = \frac{R_L^2 Z_c}{R_L-Z_c}
\]

Since we have constrained $X_B$ to be real (so that the impedance $Z_B$ is purely
reactive) we know that we must take the positive root. We also know that this
only works if $R > Z_c$. If the load is smaller than the characteristic
impedance than an LC matching network will not work. You must add some
resistance.

Now, $X_A$ is easily determined:

\begin{align*}
    X_A &= -\frac{X_B R_L^2}{X_B^2 + R_L^2} \\
        &= - \frac{X_B}{\frac{Z_c}{R_L - Z_c} + 1} \\
        &= -\frac{X_B \left( R_L - Z_c \right)}{Z_c + R_L - Z_c} \\
        &= -\frac{X_B \left( R_L - Z_c \right)}{R_L} \\
        &= -\sqrt{\frac{Z_c}{R_L - Z_c}} \left( R_L - Z_c \right) \\
        &= -\sqrt{Z_c \left( R_L-Z_c \right)}
\end{align*}

If one allows, again, $R_L = \alpha Z_c$ then

\[ 
    X_B^2 = \frac{\alpha^2 Z_c^2}{\alpha - 1} 
\]

and 

\[ 
        X_A = -Z_c\sqrt{\alpha - 1}
\]

%TODO; Determine C and L from the above equations.

The reflection coefficient for the load and the matching network can be found by
considering $ \Gamma_{in} = \frac{Z_{in} - Z_c}{Z_{in} + Z_c} $. In this case,
$\Gamma_{in}$ is a function of frequency. Plotting it as a function of frequency
yields the following:

%TODO: Determine and plot the reflection coefficient as a function of frequency
